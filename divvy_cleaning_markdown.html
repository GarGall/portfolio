<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="G. Gallagher" />
  <meta name="dcterms.date" content="2023-07-24" />
  <title>Divvy_Study_Cleaning_Markdown</title>

<style type="text/css" charset="utf-8">

body {

margin: 0.5em auto;
padding: 0.5em;
max-width: 48em;
}
code, code * { font-family: inherit; }
@media only screen and (max-width: 768px) {
body { max-width: 100%; }
}
</style>

  
  <style type="text/css">:root {
--nc-font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
--nc-font-mono: Consolas, monaco, 'Ubuntu Mono', 'Liberation Mono', 'Courier New', Courier, monospace;

--nc-tx-1: #000000;
--nc-tx-2: #1A1A1A;
--nc-bg-1: #FFFFFF;
--nc-bg-2: #F6F8FA;
--nc-bg-3: #E5E7EB;
--nc-lk-1: #0070F3;
--nc-lk-2: #0366D6;
--nc-lk-tx: #FFFFFF;
--nc-ac-1: #79FFE1;
--nc-ac-tx: #0C4047;

--nc-d-tx-1: #ffffff;
--nc-d-tx-2: #eeeeee;
--nc-d-bg-1: #000000;
--nc-d-bg-2: #111111;
--nc-d-bg-3: #222222;
--nc-d-lk-1: #3291FF;
--nc-d-lk-2: #0070F3;
--nc-d-lk-tx: #FFFFFF;
--nc-d-ac-1: #7928CA;
--nc-d-ac-tx: #FFFFFF;
}
@media (prefers-color-scheme: dark) {
:root {
--nc-tx-1: var(--nc-d-tx-1);
--nc-tx-2: var(--nc-d-tx-2);
--nc-bg-1: var(--nc-d-bg-1);
--nc-bg-2: var(--nc-d-bg-2);
--nc-bg-3: var(--nc-d-bg-3);
--nc-lk-1: var(--nc-d-lk-1);
--nc-lk-2: var(--nc-d-lk-2);
--nc-lk-tx: var(--nc--dlk-tx);
--nc-ac-1: var(--nc-d-ac-1);
--nc-ac-tx: var(--nc--dac-tx);
}
}
* {

margin: 0;
padding: 0;
}
address,
area,
article,
aside,
audio,
blockquote,
datalist,
details,
dl,
fieldset,
figure,
form,
input,
iframe,
img,
meter,
nav,
ol,
optgroup,
option,
output,
p,
pre,
progress,
ruby,
section,
table,
textarea,
ul,
video {

margin-bottom: 1rem;
}
html,input,select,button {

font-family: var(--nc-font-sans);
}
body {

margin: 0 auto;
max-width: 750px;
padding: 2rem;
border-radius: 6px;
overflow-x: hidden;
word-break: break-word;
overflow-wrap: break-word;
background: var(--nc-bg-1);

color: var(--nc-tx-2);
font-size: 1.03rem;
line-height: 1.5;
}
::selection {

background: var(--nc-ac-1);
color: var(--nc-ac-tx);
}
h1,h2,h3,h4,h5,h6 {
line-height: 1;
color: var(--nc-tx-1);
padding-top: .875rem;
}
h1,
h2,
h3 {
color: var(--nc-tx-1);
padding-bottom: 2px;
margin-bottom: 8px;
border-bottom: 1px solid var(--nc-bg-2);
}
h4,
h5,
h6 {
margin-bottom: .3rem;
}
h1 {
font-size: 2.25rem;
}
h2 {
font-size: 1.85rem;
}
h3 {
font-size: 1.55rem;
}
h4 {
font-size: 1.25rem;
}
h5 {
font-size: 1rem;
}
h6 {
font-size: .875rem;
}
a {
color: var(--nc-lk-1);
}
a:hover {
color: var(--nc-lk-2);
}
abbr:hover {

cursor: help;
}
blockquote {
padding: 1.5rem;
background: var(--nc-bg-2);
border-left: 5px solid var(--nc-bg-3);
}
abbr {
cursor: help;
}
blockquote *:last-child {
padding-bottom: 0;
margin-bottom: 0;
}
header {
background: var(--nc-bg-2);
border-bottom: 1px solid var(--nc-bg-3);
padding: 2rem 1.5rem;

margin: -2rem calc(50% - 50vw) 2rem;

padding-left: calc(50vw - 50%);
padding-right: calc(50vw - 50%);
}
header h1,
header h2,
header h3 {
padding-bottom: 0;
border-bottom: 0;
}
header > *:first-child {
margin-top: 0;
padding-top: 0;
}
header > *:last-child {
margin-bottom: 0;
}
a button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
font-size: 1rem;
display: inline-block;
padding: 6px 12px;
text-align: center;
text-decoration: none;
white-space: nowrap;
background: var(--nc-lk-1);
color: var(--nc-lk-tx);
border: 0;
border-radius: 4px;
box-sizing: border-box;
cursor: pointer;
color: var(--nc-lk-tx);
}
a button[disabled],
button[disabled],
input[type="submit"][disabled],
input[type="reset"][disabled],
input[type="button"][disabled] {
cursor: default;
opacity: .5;

cursor: not-allowed;
}
.button:focus,
.button:enabled:hover,
button:focus,
button:enabled:hover,
input[type="submit"]:focus,
input[type="submit"]:enabled:hover,
input[type="reset"]:focus,
input[type="reset"]:enabled:hover,
input[type="button"]:focus,
input[type="button"]:enabled:hover {
background: var(--nc-lk-2);
}
a img {
margin-bottom: 0px;
}
code,
pre,
kbd,
samp {

font-family: var(--nc-font-mono);
}
code,
samp,
kbd,
pre {

background: var(--nc-bg-2);
border: 1px solid var(--nc-bg-3);
border-radius: 4px;
padding: 3px 6px;

font-size: 0.9em;
}
kbd {

border-bottom: 3px solid var(--nc-bg-3);
}
pre {
padding: 1rem 1.4rem;
max-width: 100%;
overflow: auto;
}
pre code {

background: inherit;
font-size: inherit;
color: inherit;
border: 0;
padding: 0;
margin: 0;
}
code pre {

display: inline;
background: inherit;
font-size: inherit;
color: inherit;
border: 0;
padding: 0;
margin: 0;
}
details {

padding: .6rem 1rem;
background: var(--nc-bg-2);
border: 1px solid var(--nc-bg-3);
border-radius: 4px;
}
summary {

cursor: pointer;
font-weight: bold;
}
details[open] {

padding-bottom: .75rem;
}
details[open] summary {

margin-bottom: 6px;
}
details[open]>*:last-child {

margin-bottom: 0;
}
dt {
font-weight: bold;
}
dd::before {

content: '→ ';
}
hr {

border: 0;
border-bottom: 1px solid var(--nc-bg-3);
margin: 1rem auto;
}
fieldset {
margin-top: 1rem;
padding: 2rem;
border: 1px solid var(--nc-bg-3);
border-radius: 4px;
}
legend {
padding: auto .5rem;
}
table {

border-collapse: collapse;
width: 100%
}
td,
th {
border: 1px solid var(--nc-bg-3);
text-align: left;
padding: .5rem;
}
th {
background: var(--nc-bg-2);
}
tr:nth-child(even) {

background: var(--nc-bg-2);
}
table caption {
font-weight: bold;
margin-bottom: .5rem;
}
textarea {

max-width: 100%;
}
ol,
ul {

padding-left: 2rem;
}
li {
margin-top: .4rem;
}
ul ul,
ol ul,
ul ol,
ol ol {
margin-bottom: 0;
}
mark {
padding: 3px 6px;
background: var(--nc-ac-1);
color: var(--nc-ac-tx);
}
textarea,
select,
input {
padding: 6px 12px;
margin-bottom: .5rem;
background: var(--nc-bg-2);
color: var(--nc-tx-2);
border: 1px solid var(--nc-bg-3);
border-radius: 4px;
box-shadow: none;
box-sizing: border-box;
}
img {
max-width: 100%;
}
</style>

<style type="text/css" charset="utf-8">

img { max-width: 100%; }
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: auto;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } 
code span.al { color: #ad0000; } 
code span.an { color: #5e5e5e; } 
code span.at { color: #657422; } 
code span.bn { color: #ad0000; } 
code span.bu { } 
code span.cf { color: #00769e; } 
code span.ch { color: #20794d; } 
code span.cn { color: #8f5902; } 
code span.co { color: #5e5e5e; } 
code span.cv { color: #5e5e5e; font-style: italic; } 
code span.do { color: #5e5e5e; font-style: italic; } 
code span.dt { color: #ad0000; } 
code span.dv { color: #ad0000; } 
code span.er { color: #ad0000; } 
code span.ex { } 
code span.fl { color: #ad0000; } 
code span.fu { color: #4758ab; } 
code span.im { } 
code span.in { color: #5e5e5e; } 
code span.kw { color: #00769e; } 
code span.op { color: #5e5e5e; } 
code span.ot { color: #00769e; } 
code span.pp { color: #ad0000; } 
code span.sc { color: #5e5e5e; } 
code span.ss { color: #20794d; } 
code span.st { color: #20794d; } 
code span.va { color: #111111; } 
code span.vs { color: #20794d; } 
code span.wa { color: #5e5e5e; font-style: italic; } 
</style>
<script>
// remove everything from pandoc code styles _except_ for 'code span' colors
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      if (/^code span/.test(rule.selectorText)) {
        j++;
        continue;
      }
      sheets[i].deleteRule(j);
    }
  }
})();
</script>

<style>
code, pre { overflow: auto; }
pre code, pre code:not([class]) { white-space: unset; }
</style>


</head>
<body>


<main>
<header>
<h1 id="title" class="toc-ignore">Divvy_Study_Cleaning_Markdown</h1>
<p id="date">2023-07-24</p>
<p id="author">G. Gallagher</p>

</header>
<ul>
<li><a href="#pulling-in-the-data" id="toc-pulling-in-the-data">Pulling
In The Data</a></li>
<li><a href="#cleaning-the-data" id="toc-cleaning-the-data">Cleaning The
Data</a>
<ul>
<li><a href="#data-type-constraints" id="toc-data-type-constraints">Data
Type Constraints</a></li>
<li><a href="#data-range-constraints" id="toc-data-range-constraints">Data Range Constraints</a></li>
<li><a href="#check-uniqueness-constraints" id="toc-check-uniqueness-constraints">Check Uniqueness
Constraints</a></li>
<li><a href="#check-membership-constraints-for-categorical-data" id="toc-check-membership-constraints-for-categorical-data">Check
Membership Constraints for Categorical Data</a></li>
<li><a href="#check-length-validation" id="toc-check-length-validation">Check Length Validation</a></li>
<li><a href="#check-inconsistent-text-data-formatting" id="toc-check-inconsistent-text-data-formatting">Check Inconsistent Text
Data Formatting</a></li>
<li><a href="#check-unit-uniformity" id="toc-check-unit-uniformity">Check Unit Uniformity</a></li>
</ul></li>
<li><a href="#create-a-master-data-set-for-stations-and-their-location" id="toc-create-a-master-data-set-for-stations-and-their-location">Create
A Master Data Set For Stations And Their Location</a>
<ul>
<li><a href="#check-for-missing-public-rack-identifier" id="toc-check-for-missing-public-rack-identifier">Check for Missing
“Public Rack” Identifier</a></li>
<li><a href="#fix-alternate-spellings" id="toc-fix-alternate-spellings">Fix Alternate Spellings</a></li>
<li><a href="#remove-non-user-trip-logs" id="toc-remove-non-user-trip-logs">Remove Non-user Trip Logs</a></li>
<li><a href="#fix-master-set" id="toc-fix-master-set">Fix Master
Set</a></li>
<li><a href="#add-to-master-set" id="toc-add-to-master-set">Add to
Master Set</a></li>
<li><a href="#check-high-variations" id="toc-check-high-variations">Check High Variations</a></li>
</ul></li>
<li><a href="#cleaning-the-data---resumed" id="toc-cleaning-the-data---resumed">Cleaning The Data - Resumed</a>
<ul>
<li><a href="#check-cross-field-validation" id="toc-check-cross-field-validation">Check Cross Field
Validation</a></li>
<li><a href="#check-for-near-duplicates" id="toc-check-for-near-duplicates">Check for Near Duplicates</a></li>
<li><a href="#check-missing-or-anomalous-data" id="toc-check-missing-or-anomalous-data">Check Missing or Anomalous
Data</a></li>
</ul></li>
<li><a href="#rerun-tests-on-clean-data" id="toc-rerun-tests-on-clean-data">Rerun Tests On Clean Data</a>
<ul>
<li><a href="#trips" id="toc-trips">Trips</a></li>
<li><a href="#trips_wloc" id="toc-trips_wloc">Trips_wloc</a></li>
</ul></li>
</ul>

<h1 id="pulling-in-the-data">Pulling In The Data</h1>
<p>The journey data was sourced from <a href="https://divvy-tripdata.s3.amazonaws.com/index.html">here</a>;
after which I changed the filename of ‘202209-divvy-publictripdata’ to
202209-divvy-tripdata’ to align with the rest of the file structure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>trip_data_05_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202205-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>trip_data_06_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202206-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>trip_data_07_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202207-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>trip_data_08_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202208-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>trip_data_09_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202209-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>trip_data_10_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202210-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>trip_data_11_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202211-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>trip_data_12_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202212-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>trip_data_01_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202301-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>trip_data_02_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202302-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>trip_data_03_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202303-divvy-tripdata.csv&quot;</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>trip_data_04_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Dataset/202304-divvy-tripdata.csv&quot;</span>)</span></code></pre></div>
<p>This was then combined into one master set.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> <span class="fu">rbind</span>(trip_data_01_2023, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>               trip_data_02_2023,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>               trip_data_03_2023,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>               trip_data_04_2023,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               trip_data_05_2022,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               trip_data_06_2022,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               trip_data_07_2022,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>               trip_data_08_2022,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>               trip_data_09_2022,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>               trip_data_10_2022,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>               trip_data_11_2022, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>               trip_data_12_2022)</span></code></pre></div>
<h1 id="cleaning-the-data">Cleaning The Data</h1>
<p>The data was then cleaned and organised:</p>
<h2 id="data-type-constraints">Data Type Constraints</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(trips)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(trips<span class="sc">$</span>rideable_type)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#‘docked_bike’ is the old name for ‘classic_bike’  </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rideable_type =</span> <span class="fu">ifelse</span>(rideable_type <span class="sc">==</span> <span class="st">&quot;docked_bike&quot;</span>, <span class="st">&quot;classic_bike&quot;</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                                rideable_type))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>rideable_type <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(trips<span class="sc">$</span>rideable_type)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(trips<span class="sc">$</span>member_casual)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>member_casual <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(trips<span class="sc">$</span>member_casual)</span></code></pre></div>
<p>I decided that ‘rideable_type’ and ‘member_casual’ would be better
off as factors.</p>
<h2 id="data-range-constraints">Data Range Constraints</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>trips <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(started_at <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="st">&#39;2022-05-01&#39;</span>) <span class="sc">|</span> ended_at <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">&#39;2023-05-01&#39;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(started_at <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">&#39;2022-05-01&#39;</span>) <span class="sc">&amp;</span> ended_at <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="st">&#39;2023-05-01&#39;</span>))</span></code></pre></div>
<p>Filtered out trips that didn’t fall inside the date range being
investigated</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>trips <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">between</span>(start_lat, <span class="dv">37</span>, <span class="dv">47</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">between</span>(start_lng, <span class="sc">-</span><span class="dv">92</span>, <span class="sc">-</span><span class="dv">82</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>trips <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">between</span>(end_lat, <span class="dv">37</span>, <span class="dv">47</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">between</span>(end_lng, <span class="sc">-</span><span class="dv">92</span>, <span class="sc">-</span><span class="dv">82</span>))</span></code></pre></div>
<p>Several trips ending at ’Green St &amp; Madison Ave*’ seem to have
lost their geotag.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>trips <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(end_station_name <span class="sc">==</span> <span class="st">&#39;Green St &amp; Madison Ave*&#39;</span> <span class="sc">|</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           start_station_name <span class="sc">==</span> <span class="st">&#39;Green St &amp; Madison Ave*&#39;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_lat =</span> <span class="fu">ifelse</span>(end_lat <span class="sc">&lt;=</span> <span class="dv">37</span> <span class="sc">&amp;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                            end_station_name <span class="sc">==</span> <span class="st">&#39;Green St &amp; Madison Ave*&#39;</span> <span class="sc">&amp;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                            end_station_id <span class="sc">==</span> <span class="st">&#39;chargingstx07&#39;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                            <span class="fl">41.8818</span>, end_lat))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_lng =</span> <span class="fu">ifelse</span>(end_lng <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">82</span> <span class="sc">&amp;</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                            end_station_name <span class="sc">==</span> <span class="st">&#39;Green St &amp; Madison Ave*&#39;</span> <span class="sc">&amp;</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                            end_station_id <span class="sc">==</span> <span class="st">&#39;chargingstx07&#39;</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">-</span><span class="fl">87.6488</span>, end_lng))</span></code></pre></div>
<p>Filtered out trips that didn’t start/end in the Chicago area (They
were NULL values so replaced them with correct values).</p>
<h2 id="check-uniqueness-constraints">Check Uniqueness Constraints</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(trips) <span class="sc">==</span> <span class="fu">n_distinct</span>(trips<span class="sc">$</span>ride_id)) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Pass&#39;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> { </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Fail&#39;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="check-membership-constraints-for-categorical-data">Check
Membership Constraints for Categorical Data</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>unique_stations <span class="ot">&lt;-</span> <span class="fu">c</span>(trips<span class="sc">$</span>start_station_name, trips<span class="sc">$</span>end_station_name)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>unique_stations <span class="ot">&lt;-</span> <span class="fu">unique</span>(unique_stations)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>unique_stations <span class="ot">&lt;-</span> <span class="fu">sort</span>(unique_stations)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>compare_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">&#39;a&#39;</span>), <span class="fu">c</span>(<span class="st">&#39;b&#39;</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(compare_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;comparator_a&#39;</span>, <span class="st">&#39;comparator_b&#39;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> unique_stations) {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> unique_stations) {</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>      sim_val <span class="ot">&lt;-</span> <span class="fu">adist</span>(i, j)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (sim_val[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">2</span> ) {</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        compare_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(compare_df, <span class="fu">c</span>(i, j))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i, j, sim_val)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(compare_df)</span></code></pre></div>
<p>Sorts station names into unique variables; compares and isolates
variable pairs that are similar; manually check highlighted pairs for
differences resulting from input error (misspellings etc…). Several
station names differ only in a ’*’ placed at the end, seems to indicate
a ‘charging’ station, thus leaving unchanged for now.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>start_station_name <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(trips<span class="sc">$</span>start_station_name)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>end_station_name <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(trips<span class="sc">$</span>end_station_name)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>start_station_name <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;^Pubic&#39;</span>, <span class="st">&#39;Public&#39;</span>, trips<span class="sc">$</span>start_station_name)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>end_station_name <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;^Pubic&#39;</span>, <span class="st">&#39;Public&#39;</span>, trips<span class="sc">$</span>end_station_name)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check full list</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">as_tibble</span>(unique_stations))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>start_station_name <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;amp;&#39;</span>, <span class="st">&#39;&#39;</span>, trips<span class="sc">$</span>start_station_name)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>end_station_name <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;amp;&#39;</span>, <span class="st">&#39;&#39;</span>, trips<span class="sc">$</span>end_station_name)</span></code></pre></div>
<ul>
<li>Corrected double spacing</li>
<li>Corrected misspelling of “public”</li>
<li>Corrected ” ” shown as “amp;”</li>
</ul>
<h2 id="check-length-validation">Check Length Validation</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">max</span>(<span class="fu">nchar</span>(trips<span class="sc">$</span>ride_id)) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">nchar</span>(trips<span class="sc">$</span>ride_id))) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Pass&#39;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;Fail&#39;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Checks that ride_id is a consistent length</p>
<h2 id="check-inconsistent-text-data-formatting">Check Inconsistent Text
Data Formatting</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> trips<span class="sc">$</span>ride_id) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;^[[:alnum:]]+$&quot;</span>, i)) {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(i)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Pass&#39;</span>)</span></code></pre></div>
<p>Checks that ride_id only contains alphanumeric characters</p>
<h2 id="check-unit-uniformity">Check Unit Uniformity</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>decimalplaces <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((x <span class="sc">%%</span> <span class="dv">1</span>) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nchar</span>(<span class="fu">strsplit</span>(<span class="fu">sub</span>(<span class="st">&#39;0+$&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="fu">as.character</span>(x)), <span class="st">&quot;.&quot;</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)[[<span class="dv">1</span>]][[<span class="dv">2</span>]])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>dec_chk <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  unq <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> unq) {</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">decimalplaces</span>(i) <span class="sc">!=</span> y) {</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&#39;Fail - &#39;</span>, i))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Pass&#39;</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(unq, i)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dec_chk</span>(trips<span class="sc">$</span>start_lat, <span class="dv">5</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 significant figures gives an accuracy of +-0.00005degrees or +-5m in distance. </span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>sig_fig_chk <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((x <span class="sc">%%</span> <span class="dv">1</span>) <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nchar</span>(<span class="fu">strsplit</span>(<span class="fu">as.character</span>(x), <span class="st">&quot;.&quot;</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)[[<span class="dv">1</span>]][[<span class="dv">2</span>]])</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>dec_chk_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  unq <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> unq) {</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sig_fig_chk</span>(i) <span class="sc">!=</span> y) {</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&#39;Fail - &#39;</span>, i))</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Pass&#39;</span>)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(unq, i)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ^Changed to account for significant figures rather than decimal places</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dec_chk_2</span>(trips<span class="sc">$</span>start_lat, <span class="dv">5</span>)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>sigfig_6 <span class="ot">&lt;-</span> <span class="fu">filter</span>(trips, <span class="fu">nchar</span>(trips<span class="sc">$</span>start_lat) <span class="sc">&gt;=</span> <span class="dv">7</span>)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">nrow</span>(trips) <span class="sc">-</span> <span class="fu">nrow</span>(sigfig_6)))</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dec_chk, dec_chk_2, decimalplaces, sig_fig_chk, sigfig_6)</span></code></pre></div>
<p>Removing records where latitude/longitude has an accuracy of less
than 6 significant figures (sf) removes over 1,400,000 records, however
using lat/lng of 5, 4, 3… sf gives an accuracy of +-50, +-500, +-5000m
respectively. Thus, this leaves three options: the inaccurate rows are
removed; the lat/lng columns are dropped; or the inaccurate lat/lng
values are replaced from a master set of lat/lng values for the station
name / station id found in the row. This last option is the one that
will be applied moving forward.</p>
<h1 id="create-a-master-data-set-for-stations-and-their-location">Create
A Master Data Set For Stations And Their Location</h1>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stn_mst_s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;name&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_station_name,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_station_id,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lat&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_lat,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lng&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_lng)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>stn_mst_e <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;name&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_station_name,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_station_id,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lat&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_lat,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lng&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_lng)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stn_mst_s, stn_mst_e)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(stn_mst_s, stn_mst_e)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(lat) <span class="sc">==</span> <span class="dv">7</span> <span class="sc">&amp;</span> <span class="fu">nchar</span>(lng) <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, id) <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&#39;lat&#39;</span> <span class="ot">=</span> <span class="fu">mean</span>(lat), <span class="st">&#39;lng&#39;</span> <span class="ot">=</span> <span class="fu">mean</span>(lng))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>stns_u6sf <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(start_station_name <span class="sc">%in%</span> stn_mst<span class="sc">$</span>name))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>stns_u6sf <span class="sc">%&gt;%</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(start_station_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(stns_u6sf)</span></code></pre></div>
<p>Over 1000 stations aren’t recorded to enough accuracy, thus I will
bring in the lat/lng values from external sources and match them to the
stations using the station names.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Divvy_Bicycle_Stations_Master.csv&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">duplicated</span>(stn_mst<span class="sc">$</span>ID)))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">duplicated</span>(stn_mst<span class="sc">$</span><span class="st">`</span><span class="at">Station Name</span><span class="st">`</span>)))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Use station name as primary key</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> stn_mst<span class="sc">$</span><span class="st">`</span><span class="at">Station Name</span><span class="st">`</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;docks&quot;</span> <span class="ot">=</span> stn_mst<span class="sc">$</span><span class="st">`</span><span class="at">Total Docks</span><span class="st">`</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lat&quot;</span> <span class="ot">=</span> stn_mst<span class="sc">$</span>Latitude,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lng&quot;</span> <span class="ot">=</span> stn_mst<span class="sc">$</span>Longitude)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>stn_mst<span class="sc">$</span>stn <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(stn_mst<span class="sc">$</span>stn)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">arrange</span>(stn_mst, stn)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(trips<span class="sc">$</span>start_station_name, trips<span class="sc">$</span>end_station_name))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> na_chk[<span class="sc">!</span>(na_chk <span class="sc">%in%</span> stn_mst<span class="sc">$</span>stn)]</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">as_tibble</span>(na_chk))</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> na_chk[<span class="sc">!</span><span class="fu">is.na</span>(na_chk)]</span></code></pre></div>
<h2 id="check-for-missing-public-rack-identifier">Check for Missing
“Public Rack” Identifier</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">%in%</span> na_chk,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">paste</span>(<span class="st">&quot;Public Rack -&quot;</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                            start_station_name),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">%in%</span> na_chk,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">paste</span>(<span class="st">&quot;Public Rack -&quot;</span>, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                                            end_station_name),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                                     end_station_name),)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(trips<span class="sc">$</span>start_station_name, trips<span class="sc">$</span>end_station_name))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> na_chk[<span class="sc">!</span>(na_chk <span class="sc">%in%</span> stn_mst<span class="sc">$</span>stn)]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">as_tibble</span>(na_chk))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">%in%</span> na_chk,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">sub</span>(<span class="st">&quot;^Public Rack - &quot;</span>, <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                                         start_station_name),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">%in%</span> na_chk,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">sub</span>(<span class="st">&quot;^Public Rack - &quot;</span>, <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                                       end_station_name),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                                   end_station_name),)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(trips<span class="sc">$</span>start_station_name, trips<span class="sc">$</span>end_station_name))</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> na_chk[<span class="sc">!</span>(na_chk <span class="sc">%in%</span> stn_mst<span class="sc">$</span>stn)]</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">as_tibble</span>(na_chk))</span></code></pre></div>
<h2 id="fix-alternate-spellings">Fix Alternate Spellings</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;63rd &amp; Western Ave - north corner&quot;</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                                           start_station_name),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - 63rd &amp; Western Ave N&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;63rd &amp; Western Ave - north corner&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                         end_station_name),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - 63rd &amp; Western Ave N&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;63rd &amp; Western Ave - south corner&quot;</span>, </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                                           start_station_name),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - 63rd &amp; Western Ave S&quot;</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;63rd &amp; Western Ave - south corner&quot;</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                                         end_station_name),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - 63rd &amp; Western Ave S&quot;</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Ashland Ave &amp; 45th St - midblock south&quot;</span>, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                                           start_station_name),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Ashland Ave &amp; 45th St  S&quot;</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Ashland Ave &amp; 45th St - midblock south&quot;</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>                                         end_station_name),</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Ashland Ave &amp; 45th St  S&quot;</span>,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips<span class="sc">%&gt;%</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Austin Ave &amp; Wellington Ave - midblock&quot;</span>, </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>                                           start_station_name),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Austin Ave &amp; Wellington Ave&quot;</span>,</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Austin Ave &amp; Wellington Ave - midblock&quot;</span>,</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>                                         end_station_name),</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Austin Ave &amp; Wellington Ave&quot;</span>,</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Broadway &amp; Wilson Ave&quot;</span>,</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Broadway &amp; Wilson - Truman College Vaccination Site&quot;</span>,</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Broadway &amp; Wilson Ave&quot;</span>,</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Broadway &amp; Wilson - Truman College Vaccination Site&quot;</span>,</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;City Rack - Albany Ave &amp; 103rd St&quot;</span>,</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Albany Ave &amp; 103rd St&quot;</span>,</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;City Rack - Albany Ave &amp; 103rd St&quot;</span>,</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Albany Ave &amp; 103rd St&quot;</span>,</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;410&quot;</span>,</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Campbell Ave &amp; Augusta Blvd&quot;</span>,</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;410&quot;</span>,</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Campbell Ave &amp; Augusta Blvd&quot;</span>,</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="do">#### Linked through id</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Ewing Ave &amp; 96th St&quot;</span>,</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Ewing Ave &amp; 96th St N&quot;</span>,</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Ewing Ave &amp; 96th St&quot;</span>,</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Ewing Ave &amp; 96th St N&quot;</span>,</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Green St &amp; Madison St&quot;</span>,</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Green St &amp; Madison Ave*&quot;</span>,</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Green St &amp; Madison St&quot;</span>,</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Green St &amp; Madison Ave*&quot;</span>,</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Kedvale Ave &amp; 63rd St&quot;</span>,</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Kedvale Ave &amp; 63rd St E&quot;</span>,</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Kedvale Ave &amp; 63rd St&quot;</span>,</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Kedvale Ave &amp; 63rd St E&quot;</span>,</span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - East&quot;</span>,</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - E&quot;</span>,</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - East&quot;</span>,</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - E&quot;</span>,</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Kedzie &amp; 103rd St - West&quot;</span>,</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - W&quot;</span>,</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Kedzie &amp; 103rd St - West&quot;</span>,</span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - W&quot;</span>,</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Kedzie Ave &amp; 61st Pl&quot;</span>,</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Kedzie Ave &amp; 61st Pl E&quot;</span>,</span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Kedzie Ave &amp; 61st Pl&quot;</span>,</span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Kedzie Ave &amp; 61st Pl E&quot;</span>,</span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Keeler Ave &amp; Madison St&quot;</span>,</span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Keeler Ave &amp; Madison St S&quot;</span>,</span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Keeler Ave &amp; Madison St&quot;</span>,</span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Keeler Ave &amp; Madison St S&quot;</span>,</span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Kenneth Ave &amp; 63rd St&quot;</span>,</span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Kenneth Ave &amp; 63rd St E&quot;</span>,</span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Kenneth Ave &amp; 63rd St&quot;</span>,</span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Kenneth Ave &amp; 63rd St E&quot;</span>,</span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St - NW&quot;</span>,</span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St NW&quot;</span>,</span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St - NW&quot;</span>,</span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St NW&quot;</span>,</span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Lafayette Ave &amp; 87th St - SW&quot;</span>,</span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St SW&quot;</span>,</span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Lafayette Ave &amp; 87th St - SW&quot;</span>,</span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St SW&quot;</span>,</span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Lincoln Ave &amp; Roscoe St&quot;</span>,</span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Lincoln Ave &amp; Roscoe St*&quot;</span>,</span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a>                                   start_station_name),</span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a>       <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Lincoln Ave &amp; Roscoe St&quot;</span>,</span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Lincoln Ave &amp; Roscoe St*&quot;</span>,</span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true" tabindex="-1"></a>                                 end_station_name))</span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Loomis St &amp; Lexington St&quot;</span>,</span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Loomis St &amp; Lexington St*&quot;</span>,</span>
<span id="cb16-158"><a href="#cb16-158" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Loomis St &amp; Lexington St&quot;</span>,</span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Loomis St &amp; Lexington St*&quot;</span>,</span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Malcolm X College&quot;</span>,</span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Malcolm X College Vaccination Site&quot;</span>,</span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Malcolm X College&quot;</span>,</span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Malcolm X College Vaccination Site&quot;</span>,</span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Morgan St &amp; Lake St&quot;</span>,</span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Morgan St &amp; Lake St*&quot;</span>,</span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Morgan St &amp; Lake St&quot;</span>,</span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Morgan St &amp; Lake St*&quot;</span>,</span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Mt Greenwood Library - North&quot;</span>,</span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Mt Greenwood Library N&quot;</span>,</span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Mt Greenwood Library - North&quot;</span>,</span>
<span id="cb16-184"><a href="#cb16-184" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Mt Greenwood Library N&quot;</span>,</span>
<span id="cb16-185"><a href="#cb16-185" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-186"><a href="#cb16-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-187"><a href="#cb16-187" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-188"><a href="#cb16-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Mt Greenwood Library - South&quot;</span>,</span>
<span id="cb16-189"><a href="#cb16-189" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Mt Greenwood Library S&quot;</span>,</span>
<span id="cb16-190"><a href="#cb16-190" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-191"><a href="#cb16-191" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Mt Greenwood Library - South&quot;</span>,</span>
<span id="cb16-192"><a href="#cb16-192" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Mt Greenwood Library S&quot;</span>,</span>
<span id="cb16-193"><a href="#cb16-193" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-194"><a href="#cb16-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-195"><a href="#cb16-195" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-196"><a href="#cb16-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;NA&quot;</span>,</span>
<span id="cb16-197"><a href="#cb16-197" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">NA</span>,</span>
<span id="cb16-198"><a href="#cb16-198" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-199"><a href="#cb16-199" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;NA&quot;</span>,</span>
<span id="cb16-200"><a href="#cb16-200" aria-hidden="true" tabindex="-1"></a>                                   <span class="cn">NA</span>,</span>
<span id="cb16-201"><a href="#cb16-201" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-202"><a href="#cb16-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-203"><a href="#cb16-203" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-204"><a href="#cb16-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Prairie Ave &amp; 47th St - midblock&quot;</span>,</span>
<span id="cb16-205"><a href="#cb16-205" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Prairie Ave &amp; 47th St&quot;</span>,</span>
<span id="cb16-206"><a href="#cb16-206" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-207"><a href="#cb16-207" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Prairie Ave &amp; 47th St - midblock&quot;</span>,</span>
<span id="cb16-208"><a href="#cb16-208" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Prairie Ave &amp; 47th St&quot;</span>,</span>
<span id="cb16-209"><a href="#cb16-209" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-210"><a href="#cb16-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-211"><a href="#cb16-211" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-212"><a href="#cb16-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Austin Ave &amp; Wellington Ave - midblock&quot;</span>,</span>
<span id="cb16-213"><a href="#cb16-213" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Austin Ave &amp; Wellington Ave&quot;</span>,</span>
<span id="cb16-214"><a href="#cb16-214" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-215"><a href="#cb16-215" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Austin Ave &amp; Wellington Ave - midblock&quot;</span>,</span>
<span id="cb16-216"><a href="#cb16-216" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Austin Ave &amp; Wellington Ave&quot;</span>,</span>
<span id="cb16-217"><a href="#cb16-217" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-218"><a href="#cb16-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-219"><a href="#cb16-219" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-220"><a href="#cb16-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - California Ave &amp; Marquette Rd&quot;</span>,</span>
<span id="cb16-221"><a href="#cb16-221" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;California Ave &amp; Marquette Rd&quot;</span>,</span>
<span id="cb16-222"><a href="#cb16-222" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-223"><a href="#cb16-223" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - California Ave &amp; Marquette Rd&quot;</span>,</span>
<span id="cb16-224"><a href="#cb16-224" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;California Ave &amp; Marquette Rd&quot;</span>,</span>
<span id="cb16-225"><a href="#cb16-225" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-226"><a href="#cb16-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-227"><a href="#cb16-227" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-228"><a href="#cb16-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Kedvale Ave &amp; 63rd St&quot;</span>,</span>
<span id="cb16-229"><a href="#cb16-229" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Kedvale Ave &amp; 63rd St E&quot;</span>,</span>
<span id="cb16-230"><a href="#cb16-230" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-231"><a href="#cb16-231" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Kedvale Ave &amp; 63rd St&quot;</span>,</span>
<span id="cb16-232"><a href="#cb16-232" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Kedvale Ave &amp; 63rd St E&quot;</span>,</span>
<span id="cb16-233"><a href="#cb16-233" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-234"><a href="#cb16-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-235"><a href="#cb16-235" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-236"><a href="#cb16-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Kedzie Ave &amp; 61st Pl&quot;</span>,</span>
<span id="cb16-237"><a href="#cb16-237" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Kedzie Ave &amp; 61st Pl E&quot;</span>,</span>
<span id="cb16-238"><a href="#cb16-238" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-239"><a href="#cb16-239" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Kedzie Ave &amp; 61st Pl&quot;</span>,</span>
<span id="cb16-240"><a href="#cb16-240" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Kedzie Ave &amp; 61st Pl E&quot;</span>,</span>
<span id="cb16-241"><a href="#cb16-241" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-242"><a href="#cb16-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-243"><a href="#cb16-243" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-244"><a href="#cb16-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Komensky Ave &amp; 31st St&quot;</span>,</span>
<span id="cb16-245"><a href="#cb16-245" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Komensky Ave &amp; 31st St&quot;</span>,</span>
<span id="cb16-246"><a href="#cb16-246" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-247"><a href="#cb16-247" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Komensky Ave &amp; 31st St&quot;</span>,</span>
<span id="cb16-248"><a href="#cb16-248" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Komensky Ave &amp; 31st St&quot;</span>,</span>
<span id="cb16-249"><a href="#cb16-249" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-250"><a href="#cb16-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-251"><a href="#cb16-251" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-252"><a href="#cb16-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Prairie Ave &amp; Garfield Blvd&quot;</span>,</span>
<span id="cb16-253"><a href="#cb16-253" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Prairie Ave &amp; Garfield Blvd&quot;</span>,</span>
<span id="cb16-254"><a href="#cb16-254" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-255"><a href="#cb16-255" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Prairie Ave &amp; Garfield Blvd&quot;</span>,</span>
<span id="cb16-256"><a href="#cb16-256" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Prairie Ave &amp; Garfield Blvd&quot;</span>,</span>
<span id="cb16-257"><a href="#cb16-257" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-258"><a href="#cb16-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-259"><a href="#cb16-259" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-260"><a href="#cb16-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St - NE&quot;</span>,</span>
<span id="cb16-261"><a href="#cb16-261" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St N&quot;</span>,</span>
<span id="cb16-262"><a href="#cb16-262" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-263"><a href="#cb16-263" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St - NE&quot;</span>,</span>
<span id="cb16-264"><a href="#cb16-264" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St N&quot;</span>,</span>
<span id="cb16-265"><a href="#cb16-265" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-266"><a href="#cb16-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-267"><a href="#cb16-267" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-268"><a href="#cb16-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St - SE&quot;</span>,</span>
<span id="cb16-269"><a href="#cb16-269" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St S&quot;</span>,</span>
<span id="cb16-270"><a href="#cb16-270" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-271"><a href="#cb16-271" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St - SE&quot;</span>,</span>
<span id="cb16-272"><a href="#cb16-272" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Woodlawn Ave &amp; 63rd St S&quot;</span>,</span>
<span id="cb16-273"><a href="#cb16-273" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-274"><a href="#cb16-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-275"><a href="#cb16-275" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-276"><a href="#cb16-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Pulaski Rd &amp; 41st&quot;</span>,</span>
<span id="cb16-277"><a href="#cb16-277" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Pulaski Rd &amp; 41st&quot;</span>,</span>
<span id="cb16-278"><a href="#cb16-278" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-279"><a href="#cb16-279" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Pulaski Rd &amp; 41st&quot;</span>,</span>
<span id="cb16-280"><a href="#cb16-280" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Pulaski Rd &amp; 41st&quot;</span>,</span>
<span id="cb16-281"><a href="#cb16-281" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-282"><a href="#cb16-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-283"><a href="#cb16-283" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-284"><a href="#cb16-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Talman Ave &amp; 51st St - midblock&quot;</span>,</span>
<span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Talman Ave &amp; 51st St&quot;</span>,</span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Talman Ave &amp; 51st St - midblock&quot;</span>,</span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Talman Ave &amp; 51st St&quot;</span>,</span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Wentworth Ave &amp; Cermak Rd&quot;</span>,</span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Wentworth Ave &amp; Cermak Rd*&quot;</span>,</span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-295"><a href="#cb16-295" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Wentworth Ave &amp; Cermak Rd&quot;</span>,</span>
<span id="cb16-296"><a href="#cb16-296" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Wentworth Ave &amp; Cermak Rd*&quot;</span>,</span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Whippie St &amp; 26th St&quot;</span>,</span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Whipple St &amp; 26th St&quot;</span>,</span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Whippie St &amp; 26th St&quot;</span>,</span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Whipple St &amp; 26th St&quot;</span>,</span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Laflin St &amp;51st ST&quot;</span>,</span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Laflin St &amp; 51st St&quot;</span>,</span>
<span id="cb16-310"><a href="#cb16-310" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-311"><a href="#cb16-311" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Laflin St &amp;51st ST&quot;</span>,</span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Laflin St &amp; 51st St&quot;</span>,</span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Maryland Ave &amp; 87th ST&quot;</span>,</span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Maryland Ave &amp; 87th St&quot;</span>,</span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Maryland Ave &amp; 87th ST&quot;</span>,</span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Maryland Ave &amp; 87th St&quot;</span>,</span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Throop St &amp; 48t ST&quot;</span>,</span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - Throop St &amp; 48th St&quot;</span>,</span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-327"><a href="#cb16-327" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - Throop St &amp; 48t ST&quot;</span>,</span>
<span id="cb16-328"><a href="#cb16-328" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - Throop St &amp; 48th St&quot;</span>,</span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - State ST &amp; 42nd St&quot;</span>,</span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Public Rack - State St &amp; 42nd St&quot;</span>,</span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Public Rack - State ST &amp; 42nd St&quot;</span>,</span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Public Rack - State St &amp; 42nd St&quot;</span>,</span>
<span id="cb16-337"><a href="#cb16-337" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span></code></pre></div>
<h2 id="remove-non-user-trip-logs">Remove Non-user Trip Logs</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips<span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">&quot;Base - 2132 W Hubbard&quot;</span>, start_station_name) <span class="sc">|</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">grepl</span>(<span class="st">&quot;Base - 2132 W Hubbard&quot;</span>, end_station_name)))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>rmv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DIVVY CASSETTE REPAIR MOBILE STATION&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Hastings LWS&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;NewHastings&quot;</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;WEST CHI-WATSON&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;WestChi&quot;</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(start_station_name <span class="sc">%in%</span> rmv <span class="sc">|</span> end_station_name <span class="sc">%in%</span> rmv))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(rmv)</span></code></pre></div>
<p>These stations are the ones used by maintenance</p>
<h2 id="fix-master-set">Fix Master Set</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Green St &amp; Madison St&quot;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Green St &amp; Madison Ave*&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - East&quot;</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Public Rack - Kedzie &amp; 103rd St - E&quot;</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St - NW&quot;</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Public Rack - Lafayette Ave &amp; 87th St NW&quot;</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Loomis St &amp; Lexington St&quot;</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Loomis St &amp; Lexington St*&quot;</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Public Rack - Mt Greenwood Library - South&quot;</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Public Rack - Mt Greenwood Library S&quot;</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Pubic Rack - Pulaski Rd &amp; 41st&quot;</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Public Rack - Pulaski Rd &amp; 41st&quot;</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Wentworth Ave &amp; Cermak Rd&quot;</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Wentworth Ave &amp; Cermak Rd*&quot;</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(stn <span class="sc">==</span> <span class="st">&quot;Public Rack - Laflin St &amp;51st ST&quot;</span>))</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Public Rack - Maryland Ave &amp; 87th ST&quot;</span>,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Public Rack - Maryland Ave &amp; 87th St&quot;</span>,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Public Rack - Throop St &amp; 48t ST&quot;</span>,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Public Rack - Throop St &amp; 48th St&quot;</span>,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stn =</span> <span class="fu">ifelse</span>(stn <span class="sc">==</span> <span class="st">&quot;Public Rack - State ST &amp; 42nd St&quot;</span>,</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Public Rack - State St &amp; 42nd St&quot;</span>,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>                      stn))</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(stn <span class="sc">==</span> <span class="st">&quot;NA&quot;</span>))</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(trips<span class="sc">$</span>start_station_name, trips<span class="sc">$</span>end_station_name))</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> na_chk[<span class="sc">!</span>(na_chk <span class="sc">%in%</span> stn_mst<span class="sc">$</span>stn)]</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">as_tibble</span>(na_chk))</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>full_stn <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(trips<span class="sc">$</span>start_station_name, trips<span class="sc">$</span>end_station_name))</span></code></pre></div>
<h2 id="add-to-master-set">Add to Master Set</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>geo_lalo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> <span class="fu">paste0</span>(full_stn, <span class="st">&quot;, Chicago, IL&quot;</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(full_stn)</span></code></pre></div>
<p>Note: Geocodeio method can be temperamental</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>chkpnt_geocodio <span class="ot">&lt;-</span> <span class="fu">geo</span>(geo_lalo<span class="sc">$</span>stn, <span class="at">method =</span> <span class="st">&quot;geocodio&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>chkpnt_arcgis <span class="ot">&lt;-</span> <span class="fu">geo</span>(geo_lalo<span class="sc">$</span>stn, <span class="at">method =</span> <span class="st">&quot;arcgis&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>chkpnt_census <span class="ot">&lt;-</span> <span class="fu">geo</span>(geo_lalo<span class="sc">$</span>stn, <span class="at">method =</span> <span class="st">&quot;census&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>chkpnt_osm <span class="ot">&lt;-</span> <span class="fu">geo</span>(geo_lalo<span class="sc">$</span>stn, <span class="at">method =</span> <span class="st">&quot;osm&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>geo_lalo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(chkpnt_geocodio,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                      chkpnt_arcgis,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                      chkpnt_census, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                      chkpnt_osm)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(geo_lalo) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;stn&#39;</span>, <span class="st">&#39;gc_lat&#39;</span>, <span class="st">&#39;gc_lng&#39;</span>, <span class="st">&#39;drop&#39;</span>, <span class="st">&#39;a_lat&#39;</span>, <span class="st">&#39;a_lng&#39;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;drop&#39;</span>, <span class="st">&#39;osm_lat&#39;</span>, <span class="st">&#39;osm_lng&#39;</span>, <span class="st">&#39;drop&#39;</span>, <span class="st">&#39;cen_lat&#39;</span>, <span class="st">&#39;cen_lng&#39;</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>geo_lalo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>stn, </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;gc_lat&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>gc_lat, </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;gc_lng&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>gc_lng,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;a_lat&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>a_lat, </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;a_lng&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>a_lng, </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;osm_lat&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>osm_lat, </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;osm_lng&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>osm_lng, </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;cen_lat&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>cen_lat, </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;cen_lng&quot;</span> <span class="ot">=</span> geo_lalo<span class="sc">$</span>cen_lng,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;var_lat&quot;</span> <span class="ot">=</span> <span class="fu">rowVars</span>(<span class="fu">as.matrix</span>(geo_lalo[ , <span class="fu">c</span>(<span class="dv">2</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="dv">5</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="dv">8</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="dv">11</span>)]),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;var_lng&quot;</span> <span class="ot">=</span> <span class="fu">rowVars</span>(<span class="fu">as.matrix</span>(geo_lalo[ , <span class="fu">c</span>(<span class="dv">3</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="dv">6</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="dv">9</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="dv">12</span>)]),</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove geocoding prep</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>geo_lalo<span class="sc">$</span>stn <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;, Chicago, IL&quot;</span>, <span class="st">&#39;&#39;</span>, <span class="fu">as.character</span>(geo_lalo<span class="sc">$</span>stn))</span></code></pre></div>
<h2 id="check-high-variations">Check High Variations</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chk <span class="ot">&lt;-</span> geo_lalo <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var_lat <span class="sc">&gt;</span> <span class="fl">0.005</span> <span class="sc">|</span> var_lng <span class="sc">&gt;</span> <span class="fl">0.005</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(chk)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(chk)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Grab mean values of Cyclist collected lat/long</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>stn_mst_s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;name&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_station_name,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lat&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_lat,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lng&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_lng)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>stn_mst_e <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;name&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_station_name,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lat&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_lat,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;lng&#39;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_lng)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>c_lalo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stn_mst_s, stn_mst_e)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(stn_mst_s, stn_mst_e)</span></code></pre></div>
<p>Only use results accurate to at least 3 decimal places, aka ~100m</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>c_lalo <span class="ot">&lt;-</span> c_lalo <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(lat) <span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">&amp;</span> <span class="fu">nchar</span>(lng) <span class="sc">&gt;</span> <span class="dv">6</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>c_lalo <span class="ot">&lt;-</span> c_lalo[<span class="fu">order</span>(c_lalo<span class="sc">$</span>name), ]</span></code></pre></div>
<p>Remove outliers</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(c_lalo<span class="sc">$</span>name)) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  tst <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(c_lalo<span class="sc">$</span>lat[<span class="fu">which</span>(c_lalo<span class="sc">$</span>name <span class="sc">==</span> i)]))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  quartiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(tst, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  IQR <span class="ot">&lt;-</span> <span class="fu">IQR</span>(tst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> quartiles[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span>IQR</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> quartiles[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>IQR</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  tst <span class="ot">&lt;-</span> tst[tst <span class="sc">&lt;</span> lower <span class="sc">&amp;</span> tst <span class="sc">&gt;</span> upper]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  c_lalo <span class="ot">&lt;-</span> c_lalo <span class="sc">%&gt;%</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(name <span class="sc">==</span> i <span class="sc">&amp;</span> lat <span class="sc">%in%</span> tst))</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  tst <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(c_lalo<span class="sc">$</span>lng[<span class="fu">which</span>(c_lalo<span class="sc">$</span>name <span class="sc">==</span> i)]))</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  quartiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(tst, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  IQR <span class="ot">&lt;-</span> <span class="fu">IQR</span>(tst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> quartiles[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span>IQR</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> quartiles[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>IQR</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  tst <span class="ot">&lt;-</span> tst[tst <span class="sc">&lt;</span> lower <span class="sc">&amp;</span> tst <span class="sc">&gt;</span> upper]</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  c_lalo <span class="ot">&lt;-</span> c_lalo <span class="sc">%&gt;%</span> </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(name <span class="sc">==</span> i <span class="sc">&amp;</span> lng <span class="sc">%in%</span> tst))</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i, IQR, lower, quartiles, tst, upper)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Done!&#39;</span>)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="do">#### Find means and variances</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>c_lalo <span class="ot">&lt;-</span> c_lalo <span class="sc">%&gt;%</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_lat =</span> <span class="fu">mean</span>(lat),</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_lng =</span> <span class="fu">mean</span>(lng),</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">var_lat =</span> <span class="fu">var</span>(lat),</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">var_lng =</span> <span class="fu">var</span>(lng))</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(c_lalo)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>c_lalo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> c_lalo<span class="sc">$</span>name,</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;c_lat&quot;</span> <span class="ot">=</span> c_lalo<span class="sc">$</span>mean_lat,</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;c_lng&quot;</span> <span class="ot">=</span> c_lalo<span class="sc">$</span>mean_lng)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>c_lalo <span class="ot">&lt;-</span> c_lalo <span class="sc">%&gt;%</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn))</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>geo_lalo <span class="ot">&lt;-</span> geo_lalo[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)]</span></code></pre></div>
<p>Compared the geocoded values and the collected cyclist trips values
to the accurate master set values to determine where to best get the
missing values from.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>scorecard <span class="ot">&lt;-</span> <span class="fu">left_join</span>(geo_lalo, c_lalo, <span class="fu">join_by</span>(<span class="st">&quot;stn&quot;</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>scorecard <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(scorecard, stn_mst, <span class="fu">join_by</span>(<span class="st">&quot;stn&quot;</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>scorecard_cor <span class="ot">&lt;-</span> scorecard <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;gc_cor&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>gc_lat, scorecard<span class="sc">$</span>lat, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;gc_cor1&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>gc_lng, scorecard<span class="sc">$</span>lng, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;a_cor&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>a_lat, scorecard<span class="sc">$</span>lat, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>), </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;a_cor1&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>a_lng, scorecard<span class="sc">$</span>lng, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;osm_cor&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>osm_lat, scorecard<span class="sc">$</span>lat, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;osm_cor1&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>osm_lng, scorecard<span class="sc">$</span>lng, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;cen_cor&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>cen_lat, scorecard<span class="sc">$</span>lat, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;cen_cor1&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>cen_lng, scorecard<span class="sc">$</span>lng, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;c_cor&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>c_lat, scorecard<span class="sc">$</span>lat, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;c_cor1&quot;</span> <span class="ot">=</span> <span class="fu">cor</span>(scorecard<span class="sc">$</span>c_lng, scorecard<span class="sc">$</span>lng, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>scorecard <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> scorecard<span class="sc">$</span>stn,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;gc_score_lat&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">13</span>)])),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;gc_score_lng&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">14</span>)])),</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;a_score_lat&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">13</span>)])),</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;a_score_lng&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">14</span>)])),</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;osm_score_lat&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">13</span>)])),</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;osm_score_lng&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>)])),</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;cen_score_lat&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">13</span>)])),</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;cen_score_lng&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">14</span>)])),</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;c_score_lat&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">13</span>)])),</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;c_score_lng&quot;</span> <span class="ot">=</span> <span class="fu">rowDiffs</span>(<span class="fu">as.matrix</span>(scorecard[ , <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>)])))</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(scorecard) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;stn&quot;</span>, <span class="st">&quot;gc_score_lat&quot;</span>, <span class="st">&quot;gc_score_lng&quot;</span>, <span class="st">&quot;a_score_lat&quot;</span>,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;a_score_lng&quot;</span>, <span class="st">&quot;osm_score_lat&quot;</span>, <span class="st">&quot;osm_score_lng&quot;</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;cen_score_lat&quot;</span>, <span class="st">&quot;cen_score_lng&quot;</span>, <span class="st">&quot;c_score_lat&quot;</span>,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;c_score_lng&quot;</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>scorecard <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;geo/c_method&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;gc&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;osm&quot;</span>, <span class="st">&quot;cen&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;mean_lat_diff&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(scorecard<span class="sc">$</span>gc_score_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>a_score_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>osm_score_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>cen_score_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>c_score_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;mean_lng_diff&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(scorecard<span class="sc">$</span>gc_score_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>a_score_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>osm_score_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>cen_score_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">mean</span>(scorecard<span class="sc">$</span>c_score_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>scorecard <span class="ot">&lt;-</span> <span class="fu">cbind</span>(scorecard,</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;cor&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;gc_cor&quot;</span> <span class="ot">=</span> (scorecard_cor[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>                                           scorecard_cor[<span class="dv">1</span>, <span class="dv">2</span>]) <span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;a_cor&quot;</span> <span class="ot">=</span> (scorecard_cor[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">+</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>                                          scorecard_cor[<span class="dv">1</span>, <span class="dv">4</span>]) <span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;osm_cor&quot;</span> <span class="ot">=</span> (scorecard_cor[<span class="dv">1</span>, <span class="dv">5</span>] <span class="sc">+</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>                                            scorecard_cor[<span class="dv">1</span>, <span class="dv">6</span>]) <span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;cen_cor&quot;</span> <span class="ot">=</span> (scorecard_cor[<span class="dv">1</span>, <span class="dv">7</span>] <span class="sc">+</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>                                            scorecard_cor[<span class="dv">1</span>, <span class="dv">8</span>]) <span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;c_cor&quot;</span> <span class="ot">=</span> (scorecard_cor[<span class="dv">1</span>, <span class="dv">9</span>] <span class="sc">+</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>                                            scorecard_cor[<span class="dv">1</span>, <span class="dv">10</span>]) <span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>scorecard <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scorecard)</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(scorecard) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;method&quot;</span>, <span class="st">&quot;mean_lat_diff&quot;</span>, <span class="st">&quot;mean_lng_diff&quot;</span>, <span class="st">&quot;cor&quot;</span>)</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>scorecard <span class="ot">&lt;-</span> scorecard <span class="sc">%&gt;%</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;diff_score&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(mean_lat_diff),</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">as.numeric</span>(mean_lng_diff)),</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;corr_score&quot;</span> <span class="ot">=</span> cor)</span></code></pre></div>
<p>Trips data has the best scores so it will take top priority, followed
by Census, Arcgis,and then Osm. Geocodio looks highly inaccurate and so
won’t be used.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(scorecard, scorecard_cor)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">full_join</span>(stn_mst, c_lalo, <span class="at">by =</span> <span class="st">&quot;stn&quot;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">full_join</span>(stn_mst, geo_lalo, <span class="at">by =</span> <span class="st">&quot;stn&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>chkpnt_geo_lalo <span class="ot">&lt;-</span> geo_lalo</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(c_lalo, geo_lalo)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> stn_mst<span class="sc">$</span>stn,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lat&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn_mst<span class="sc">$</span>lat),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                                      stn_mst<span class="sc">$</span>lat, </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn_mst<span class="sc">$</span>c_lat),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                                          stn_mst<span class="sc">$</span>c_lat,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn_mst<span class="sc">$</span>cen_lalo),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                                                 stn_mst<span class="sc">$</span>cen_lalo,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                                                 <span class="cn">NA</span>))),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lng&quot;</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn_mst<span class="sc">$</span>lng),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                                      stn_mst<span class="sc">$</span>lng, </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn_mst<span class="sc">$</span>c_lng),</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                                             stn_mst<span class="sc">$</span>c_lng,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn_mst<span class="sc">$</span>cen_lalo),</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                                                    stn_mst<span class="sc">$</span>cen_lalo,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                                                    <span class="cn">NA</span>))),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;docks&quot;</span> <span class="ot">=</span> stn_mst<span class="sc">$</span>docks)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(trips<span class="sc">$</span>start_station_name, trips<span class="sc">$</span>end_station_name))</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> na_chk[<span class="sc">!</span>(na_chk <span class="sc">%in%</span> stn_mst<span class="sc">$</span>stn)]</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">as_tibble</span>(na_chk))</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(lat) <span class="sc">|</span> <span class="fu">is.na</span>(lng))</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lat))</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>add <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Stony Island Ave &amp; 63rd St&quot;</span>,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Elizabeth St &amp; Randolph St&quot;</span>,</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Halsted St &amp; Fulton St&quot;</span>,</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Francisco Ave &amp; Chicago Ave&quot;</span>,</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Lincoln Ave &amp; Byron St&quot;</span>,</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Campbell Ave &amp; Augusta Blvd&quot;</span>,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Public Rack - Ashland Ave &amp; 45th St  S&quot;</span>,</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Lamon Ave &amp; Archer Ave&quot;</span>,</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Whipple St &amp; 26th St&quot;</span>,</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Linder Ave &amp; Archer Ave&quot;</span>),</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;lat&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">41.7806</span>,</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.8843</span>,</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.8869</span>,</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.8955</span>, </span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.9524</span>,</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.8993</span>,</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.8119</span>,</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.7982</span>,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.8446</span>,</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">41.7962</span>),</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;lng&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">87.5864</span>, </span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.6589</span>, </span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.6481</span>, </span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.6993</span>, </span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.6773</span>, </span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.6892</span>, </span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.6650</span>, </span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.7450</span>, </span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.7014</span>, </span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">-</span><span class="fl">87.7596</span>),</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;docks&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stn_mst, add)</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(add)</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_station_name =</span> <span class="fu">ifelse</span>(start_station_name <span class="sc">==</span> <span class="st">&quot;Whippie St &amp; 26th St&quot;</span>,</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">&quot;Whipple St &amp; 26th St&quot;</span>,</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>                                     start_station_name),</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_station_name =</span> <span class="fu">ifelse</span>(end_station_name <span class="sc">==</span> <span class="st">&quot;Whippie St &amp; 26th St&quot;</span>,</span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Whipple St &amp; 26th St&quot;</span>,</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>                                   end_station_name))</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>na_chk <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(lat) <span class="sc">|</span> <span class="fu">is.na</span>(lng))</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(na_chk)</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> <span class="fu">left_join</span>(trips, stn_mst, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&quot;start_station_name&quot;</span> <span class="sc">==</span> <span class="st">&quot;stn&quot;</span>))</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> <span class="fu">left_join</span>(trips, stn_mst, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">&quot;end_station_name&quot;</span> <span class="sc">==</span> <span class="st">&quot;stn&quot;</span>),</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>                    <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;.s&quot;</span>, <span class="st">&quot;.e&quot;</span>))</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_lat =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start_station_name),</span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>                            start_lat,</span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>                            lat.s),</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">start_lng =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(start_station_name),</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>                            start_lng,</span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>                            lng.s),</span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_lat =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(end_station_name),</span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>                            end_lat,</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>                            lat.e),</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>         <span class="at">end_lng =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(end_station_name),</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>                            end_lng,</span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>                            lng.e),</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;ride_id&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>ride_id,</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;rideable_type&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>rideable_type,</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;s_at&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>started_at,</span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_station_name,</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;s_lat&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_lat,</span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;s_lng&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>start_lng,</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;e_at&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>ended_at,</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_station_name,</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;e_lat&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_lat,</span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;e_lng&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>end_lng,</span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> trips<span class="sc">$</span>member_casual)</span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>stn_mst <span class="ot">&lt;-</span> stn_mst <span class="sc">%&gt;%</span></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lat =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(lat), <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>         <span class="at">lng =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(lng), <span class="at">digits =</span> <span class="dv">6</span>))</span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">s_lat =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(s_lat), <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">s_lng =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(s_lng), <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>         <span class="at">e_lat =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(e_lat), <span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a>         <span class="at">e_lng =</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(e_lng), <span class="at">digits =</span> <span class="dv">6</span>))</span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[<span class="fu">order</span>(trips<span class="sc">$</span>s_at), ]</span></code></pre></div>
<h1 id="cleaning-the-data---resumed">Cleaning The Data - Resumed</h1>
<h2 id="check-cross-field-validation">Check Cross Field Validation</h2>
<p>Trips shouldn’t have a start date after the end date</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(e_at <span class="sc">&gt;</span> s_at)</span></code></pre></div>
<p>Trips shorter than 3 mins and that start and end at the same place
are very likely to be accidental</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>solute <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">difftime</span>(e_at, s_at, <span class="at">units =</span> <span class="st">&quot;mins&quot;</span>) <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> s_stn <span class="sc">==</span> e_stn)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(solute)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[<span class="sc">!</span>(trips<span class="sc">$</span>ride_id <span class="sc">%in%</span> solute<span class="sc">$</span>ride_id), ]</span></code></pre></div>
<p>Check to ensure that this is reflective of the whole sample and not a
biased subset</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">alpha =</span> <span class="dv">1</span>) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  n <span class="sc">/</span> <span class="fu">sum</span>(n)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>comp_na <span class="ot">&lt;-</span> solute <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span> </span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_na)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>comp_trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])),</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> </span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_trips)</span></code></pre></div>
<p>The results to be filtered out are a non-biased subset of the
whole</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[<span class="sc">!</span>(trips<span class="sc">$</span>ride_id <span class="sc">%in%</span> solute<span class="sc">$</span>ride_id), ]</span></code></pre></div>
<p>Trips shorter than 1 min and don’t travel further than 150m are very
likely to be accidental</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>solute <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">difftime</span>(e_at, s_at, <span class="at">units =</span> <span class="st">&quot;mins&quot;</span>) <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> length_dis_km <span class="sc">&lt;</span> <span class="fl">0.15</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(solute)</span></code></pre></div>
<p>Check to ensure that this is reflective of the whole sample and not a
biased subset</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>comp_na <span class="ot">&lt;-</span> solute <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>]))),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span> </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_na)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>comp_trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])),</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> </span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_trips)</span></code></pre></div>
<p>The results to be filtered out are a non-biased subset of the
whole</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[<span class="sc">!</span>(trips<span class="sc">$</span>ride_id <span class="sc">%in%</span> solute<span class="sc">$</span>ride_id), ]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(solute, comp_solute, comp_trips,prob, entropy)</span></code></pre></div>
<p>Trips shouldn’t be longer than 1 day - Divvy considers bikes to be
lost or stolen if out for over 24 hours - <a href="https://help.divvybikes.com/hc/en-us/articles/360033484791-What-if-I-keep-a-bike-out-too-long-">Link</a></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>solute <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">difftime</span>(e_at, s_at, <span class="at">units =</span> <span class="st">&quot;days&quot;</span>) <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(solute)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[<span class="sc">!</span>(trips<span class="sc">$</span>ride_id <span class="sc">%in%</span> solute<span class="sc">$</span>ride_id), ]</span></code></pre></div>
<p>Trip speed shouldn’t be greater than 32km/h (Max speed of electric
bikes)</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="cf">function</span>(lat_1, lng_1, lat_2, lng_2){</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  radius <span class="ot">=</span> <span class="dv">6371</span>  <span class="co"># km</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  dlat <span class="ot">=</span> (lat_2 <span class="sc">-</span> lat_1) <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  dlon <span class="ot">=</span> (lng_2 <span class="sc">-</span> lng_1) <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="fu">sin</span>(dlat<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cos</span>(lat_1 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span>) <span class="sc">*</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cos</span>(lat_2 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span>) <span class="sc">*</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sin</span>(dlon<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">atan2</span>(<span class="fu">sqrt</span>(a), <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> a))</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">=</span> radius <span class="sc">*</span> b</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;length_dis_km&quot;</span> <span class="ot">=</span> <span class="fu">mapply</span>(distance, <span class="at">lat_1 =</span> s_lat, <span class="at">lng_1 =</span> s_lng, </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">lat_2 =</span> e_lat, <span class="at">lng_2 =</span> e_lng),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;length_time_mins&quot;</span> <span class="ot">=</span> <span class="fu">difftime</span>(e_at, s_at, <span class="at">units =</span> <span class="st">&quot;mins&quot;</span>))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">length_time_mins =</span> <span class="fu">seconds_to_period</span>(<span class="fu">as.numeric</span>(length_time_mins) <span class="sc">*</span> <span class="dv">60</span>))</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;spd_kph&quot;</span> <span class="ot">=</span> length_dis_km <span class="sc">/</span> (<span class="fu">as.numeric</span>(length_time_mins) <span class="sc">/</span> <span class="dv">3600</span>))</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>solute <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(spd_kph <span class="sc">&gt;</span> <span class="dv">32</span>)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(solute)</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[<span class="sc">!</span>(trips<span class="sc">$</span>ride_id <span class="sc">%in%</span> solute<span class="sc">$</span>ride_id), ]</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(solute, distance)</span></code></pre></div>
<h2 id="check-for-near-duplicates">Check for Near Duplicates</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>solute <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">filter</span>(trips, <span class="fu">duplicated</span>(trips[,<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>])), </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(trips, <span class="fu">duplicated</span>(trips[,<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>], <span class="at">fromLast =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(solute)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[<span class="sc">!</span>(trips<span class="sc">$</span>ride_id <span class="sc">%in%</span> solute<span class="sc">$</span>ride_id), ]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(solute)</span></code></pre></div>
<h2 id="check-missing-or-anomalous-data">Check Missing or Anomalous
Data</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>na_rideid <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(ride_id))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_rideid)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>na_rideabletype <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(rideable_type))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_rideabletype)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>na_rideabletype <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(rideable_type))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_rideabletype)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>na_sat <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(s_at))</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_sat)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>na_sstn <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(s_stn))</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_sstn)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">alpha =</span> <span class="dv">1</span>) {</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  n <span class="sc">/</span> <span class="fu">sum</span>(n)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p))</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>comp_na <span class="ot">&lt;-</span> na_sstn <span class="sc">%&gt;%</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])),</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span> </span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_na)</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>comp_trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])),</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> </span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_trips)</span></code></pre></div>
<p>The subset of NA values is biased towards electric bikes, so is not
reflective of the whole set. In addition the subset is 14% of the whole
set; thus just removing it would bias the whole data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(comp_na, comp_trips)</span></code></pre></div>
<p>Can try instead to get the stations by matching the location to the
nearest corresponding entry in the master set.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>na_sstn_1 <span class="ot">&lt;-</span> na_sstn <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(s_stn, s_lat, s_lng) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>()</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">7</span>, <span class="at">type =</span> <span class="st">&quot;SOCK&quot;</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoSNOW</span>(cl)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>na_sstn_1<span class="sc">$</span>s_stn <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(na_sstn_1), <span class="at">.combine =</span> <span class="st">&quot;c&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(<span class="st">&quot;stn&quot;</span> <span class="ot">=</span> stn_mst<span class="sc">$</span>stn, <span class="st">&quot;diff&quot;</span> <span class="ot">=</span> (<span class="fu">abs</span>(stn_mst<span class="sc">$</span>lat <span class="sc">-</span> na_sstn_1<span class="sc">$</span>s_lat[i]) <span class="sc">+</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">abs</span>(stn_mst<span class="sc">$</span>lng <span class="sc">-</span> na_sstn_1<span class="sc">$</span>s_lng[i])))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dplyr<span class="sc">::</span><span class="fu">first</span>(a<span class="sc">$</span>stn[a<span class="sc">$</span>diff <span class="sc">==</span> <span class="fu">min</span>(a<span class="sc">$</span>diff)]))</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cl)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>na_sstn<span class="sc">$</span>join_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(na_sstn<span class="sc">$</span>s_lat, na_sstn<span class="sc">$</span>s_lng)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>na_sstn_1<span class="sc">$</span>join_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(na_sstn_1<span class="sc">$</span>s_lat, na_sstn_1<span class="sc">$</span>s_lng)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>na_sstn <span class="ot">&lt;-</span> <span class="fu">left_join</span>(na_sstn, na_sstn_1, <span class="at">by =</span> <span class="st">&quot;join_key&quot;</span>, </span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_o&quot;</span>, <span class="st">&quot;_n&quot;</span>), <span class="at">relationship =</span> <span class="st">&quot;many-to-one&quot;</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>na_sstn <span class="ot">&lt;-</span> na_sstn[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">16</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">14</span>)]</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(na_sstn) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(trips)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s_stn))</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> <span class="fu">rbind</span>(trips, na_sstn)</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(na_sstn_1)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>na_slat <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(s_lat))</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_slat)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>na_slng <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(s_lng))</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_slng)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>na_eat <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(e_at))</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_eat)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>na_estn <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(e_stn))</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_estn)</span></code></pre></div>
<p>All of na_estn don’t have a end longitude as well as an end station
name; so these will have to be dropped as there is no location data to
match to the master set</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>comp_na <span class="ot">&lt;-</span> na_estn <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_na)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>comp_trips <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="st">&quot;rideable type&quot;</span> <span class="ot">=</span> </span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])) <span class="sc">/</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;classic_bike&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(rideable_type[rideable_type <span class="sc">==</span> <span class="st">&quot;electric_bike&quot;</span>])),</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_at),</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(s_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>),</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(s_stn))),</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lat),</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lat),</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(s_lng),</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;s_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(s_lng),</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_at),</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_at_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(e_at)) <span class="sc">/</span> (<span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">24</span>), </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_stn&quot;</span> <span class="ot">=</span> <span class="fu">entropy</span>(<span class="fu">prob</span>(<span class="fu">table</span>(e_stn))),</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lat_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_m&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;e_lng_sd&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(e_lng, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;m_c&quot;</span> <span class="ot">=</span> </span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">abs</span>(<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">-</span> </span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])) <span class="sc">/</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>               <span class="fu">length</span>(m_c[m_c <span class="sc">==</span> <span class="st">&quot;member&quot;</span>])))</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(comp_trips)</span></code></pre></div>
<p>However, the subset to be removed is not an unbiased section of the
whole. Therefore, the trips data set will be split into two sets; one
that shall be the main set wherein the information on end location (and
the categories dependent on end location) will be removed. And another
in which end location will be kept and instead the missing entries will
be removed, (it will also be important to caveat any findings taken from
this set with acknowledgement of the potential bias).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>trips_wloc <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(e_stn))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>trips <span class="ot">&lt;-</span> trips[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>)]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(comp_na, comp_trips)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>na_elat <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(e_lat))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_elat)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>na_elng <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(e_lng))</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_elng)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>na_mc <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(m_c))</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_mc)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>na_mc <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(m_c))</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_mc)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>na_dis <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(length_dis_km))</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_dis)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>na_time <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(length_time_mins))</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_time)</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>na_time <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(length_time_mins))</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_time)</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>na_spd <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(spd_kph))</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(na_spd)</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(na_rideid, na_rideabletype, na_sat, na_sstn, na_slat, na_slng, na_eat,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>   na_estn, na_elat, na_elng, na_mc, na_dis, na_time, na_spd, prob, comparator, </span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>   assign_nearest, entropy, solute, comp_na, comp_trips)</span></code></pre></div>
<h1 id="rerun-tests-on-clean-data">Rerun Tests On Clean Data</h1>
<h2 id="trips">Trips</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(trips)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5723727 obs. of  9 variables:
##  $ ride_id         : chr  &quot;E7EB5B75690A9720&quot; &quot;7C9B5555CD23A4A5&quot; &quot;F6A29D3852FE4B05&quot; &quot;2ADEBDB639C80F16&quot; ...
##  $ rideable_type   : chr  &quot;classic_bike&quot; &quot;electric_bike&quot; &quot;classic_bike&quot; &quot;classic_bike&quot; ...
##  $ s_at            : chr  &quot;2022-05-01T00:00:06Z&quot; &quot;2022-05-01T00:00:12Z&quot; &quot;2022-05-01T00:00:19Z&quot; &quot;2022-05-01T00:00:39Z&quot; ...
##  $ s_stn           : chr  &quot;Sheffield Ave &amp; Webster Ave&quot; &quot;Larrabee St &amp; Webster Ave&quot; &quot;Federal St &amp; Polk St&quot; &quot;Sheffield Ave &amp; Webster Ave&quot; ...
##  $ s_lat           : num  41.9 41.9 41.9 41.9 41.9 ...
##  $ s_lng           : num  -87.7 -87.6 -87.6 -87.7 -87.6 ...
##  $ e_at            : chr  &quot;2022-05-01T00:12:56Z&quot; &quot;2022-05-01T00:32:51Z&quot; &quot;2022-05-01T00:15:09Z&quot; &quot;2022-05-01T00:12:52Z&quot; ...
##  $ m_c             : chr  &quot;casual&quot; &quot;casual&quot; &quot;casual&quot; &quot;casual&quot; ...
##  $ length_time_mins: chr  &quot;12M 50S&quot; &quot;32M 39S&quot; &quot;14M 50S&quot; &quot;12M 13S&quot; ...</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;test&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Structure&quot;</span>), <span class="st">&quot;pass_fail&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(s_at <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="st">&#39;2022-05-01&#39;</span>) <span class="sc">|</span> e_at <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">&#39;2023-05-01&#39;</span>))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(test) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Date Range&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Date Range&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">between</span>(s_lat, <span class="dv">37</span>, <span class="dv">47</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">between</span>(s_lng, <span class="sc">-</span><span class="dv">92</span>, <span class="sc">-</span><span class="dv">82</span>))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(test) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Start Loc Range&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Start Loc Range&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(trips) <span class="sc">==</span> <span class="fu">n_distinct</span>(trips<span class="sc">$</span>ride_id)) {</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Range ID Uniqueness&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Range ID Uniqueness&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(stn_mst) <span class="sc">==</span> <span class="fu">n_distinct</span>(stn_mst<span class="sc">$</span>stn)) {</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Stations Master PK Uniqueness&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Stations Master PK Uniqueness&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>s_stn <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(trips<span class="sc">$</span>s_stn)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>stn_mst<span class="sc">$</span>stn <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(stn_mst<span class="sc">$</span>stn)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">max</span>(<span class="fu">nchar</span>(trips<span class="sc">$</span>ride_id)) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">nchar</span>(trips<span class="sc">$</span>ride_id))) {</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Length&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Length&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips, <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;^[[:alnum:]]+$&quot;</span>, trips<span class="sc">$</span>ride_id))) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Alphanumeric&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Alphanumeric&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>s_lat <span class="ot">&lt;-</span> <span class="fu">signif</span>(trips<span class="sc">$</span>s_lat, <span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>trips<span class="sc">$</span>s_lng <span class="ot">&lt;-</span> <span class="fu">signif</span>(trips<span class="sc">$</span>s_lng, <span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips, trips<span class="sc">$</span>e_at <span class="sc">&gt;</span> trips<span class="sc">$</span>e_at)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;End Time After Start Time&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;End Time After Start Time&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips, trips<span class="sc">$</span>length_time_mins <span class="sc">&lt;</span> <span class="dv">1</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Under 1 Min&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Under 1 Min&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips, (<span class="fu">as.numeric</span>(trips<span class="sc">$</span>length_time_mins) <span class="sc">/</span> <span class="dv">60</span>) <span class="sc">&gt;</span> <span class="dv">1440</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Over 1 Day&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Over 1 Day&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `(as.numeric(trips$length_time_mins)/60) &gt; 1440`.
## Caused by warning:
## ! NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> trips <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rideable_type, s_at, s_stn, s_lat, s_lng, e_at, m_c) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(rideable_type, s_at, s_stn, s_lat, s_lng, e_at)</span></code></pre></div>
<pre><code>## Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
## dplyr 1.1.0.
## ℹ Please use `reframe()` instead.
## ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
##   always returns an ungrouped data frame and adjust accordingly.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;rideable_type&#39;, &#39;s_at&#39;, &#39;s_stn&#39;, &#39;s_lat&#39;,
## &#39;s_lng&#39;, &#39;e_at&#39;, &#39;m_c&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(test) <span class="sc">==</span> <span class="fu">nrow</span>(trips)) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Near Duplicates&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Near Duplicates&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips, <span class="fu">is.na</span>(trips<span class="sc">$</span>ride_id) <span class="sc">|</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>rideable_type) <span class="sc">|</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>s_at) <span class="sc">|</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>s_stn) <span class="sc">|</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>s_lat) <span class="sc">|</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>s_lng) <span class="sc">|</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>e_at) <span class="sc">|</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>m_c) <span class="sc">|</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(trips<span class="sc">$</span>length_time_mins))) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No NA Values&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No NA Values&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>test_results</span></code></pre></div>
<pre><code>## # A tibble: 12 × 2
##    test                          pass_fail
##    &lt;chr&gt;                         &lt;chr&gt;    
##  1 Structure                     Pass     
##  2 Date Range                    Pass     
##  3 Start Loc Range               Pass     
##  4 Range ID Uniqueness           Pass     
##  5 Stations Master PK Uniqueness Fail     
##  6 Ride ID Length                Pass     
##  7 Ride ID Alphanumeric          Pass     
##  8 End Time After Start Time     Pass     
##  9 No Trips Under 1 Min          Pass     
## 10 No Trips Over 1 Day           Pass     
## 11 No Near Duplicates            Pass     
## 12 No NA Values                  Pass</code></pre>
<p>Investigate near duplicates</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>test_f <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(test, trips, <span class="at">by =</span> <span class="fu">join_by</span>(rideable_type, s_at, s_stn,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                                               s_lat, s_lng, e_at, m_c),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">multiple =</span> <span class="st">&quot;first&quot;</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>dups <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(trips, test_f, <span class="at">by =</span> <span class="st">&quot;ride_id&quot;</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rideable_type <span class="sc">==</span> dups<span class="sc">$</span>rideable_type[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>           s_at <span class="sc">==</span> dups<span class="sc">$</span>s_at[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>           s_stn <span class="sc">==</span> dups<span class="sc">$</span>s_stn[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>           s_lat <span class="sc">==</span> dups<span class="sc">$</span>s_lat[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>           s_lng <span class="sc">==</span> dups<span class="sc">$</span>s_lng[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>           e_at <span class="sc">==</span> dups<span class="sc">$</span>e_at[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>           m_c <span class="sc">==</span> dups<span class="sc">$</span>m_c[<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>##            ride_id rideable_type                 s_at                  s_stn
## 1 D8DB8F84896E2D47 electric_bike 2022-08-27T19:55:07Z Damen Ave &amp; Leland Ave
## 2 72F9091E73253A62 electric_bike 2022-08-27T19:55:07Z Damen Ave &amp; Leland Ave
##     s_lat   s_lng                 e_at                           e_stn   e_lat
## 1 41.9671 -87.679 2022-08-27T20:07:20Z Pine Grove Ave &amp; Irving Park Rd 41.9544
## 2 41.9671 -87.679 2022-08-27T20:07:20Z          Broadway &amp; Sheridan Rd 41.9528
##     e_lng    m_c length_dis_km length_time_mins  spd_kph
## 1 -87.648 casual      2.926499          12M 13S 14.37298
## 2 -87.650 casual      2.877197          12M 13S 14.13084</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rideable_type <span class="sc">==</span> dups<span class="sc">$</span>rideable_type[<span class="dv">2</span>] <span class="sc">&amp;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>           s_at <span class="sc">==</span> dups<span class="sc">$</span>s_at[<span class="dv">2</span>] <span class="sc">&amp;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>           s_stn <span class="sc">==</span> dups<span class="sc">$</span>s_stn[<span class="dv">2</span>] <span class="sc">&amp;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>           s_lat <span class="sc">==</span> dups<span class="sc">$</span>s_lat[<span class="dv">2</span>] <span class="sc">&amp;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>           s_lng <span class="sc">==</span> dups<span class="sc">$</span>s_lng[<span class="dv">2</span>] <span class="sc">&amp;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>           e_at <span class="sc">==</span> dups<span class="sc">$</span>e_at[<span class="dv">2</span>] <span class="sc">&amp;</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>           m_c <span class="sc">==</span> dups<span class="sc">$</span>m_c[<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>##            ride_id rideable_type                 s_at
## 1 81B50622DAD74CFB  classic_bike 2022-11-07T12:16:52Z
## 2 E1F88549C6269EB9  classic_bike 2022-11-07T12:16:52Z
##                                                 s_stn   s_lat    s_lng
## 1 Broadway &amp; Wilson - Truman College Vaccination Site 41.9652 -87.6581
## 2 Broadway &amp; Wilson - Truman College Vaccination Site 41.9652 -87.6581
##                   e_at                                   e_stn   e_lat    e_lng
## 1 2022-11-07T12:25:26Z          Southport Ave &amp; Irving Park Rd 41.9542 -87.6644
## 2 2022-11-07T12:25:26Z Wolcott (Ravenswood) Ave &amp; Montrose Ave 41.9614 -87.6762
##      m_c length_dis_km length_time_mins   spd_kph
## 1 member      1.329452           8M 34S  9.311338
## 2 member      1.555044           8M 34S 10.891360</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rideable_type <span class="sc">==</span> dups<span class="sc">$</span>rideable_type[<span class="dv">3</span>] <span class="sc">&amp;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>           s_at <span class="sc">==</span> dups<span class="sc">$</span>s_at[<span class="dv">3</span>] <span class="sc">&amp;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>           s_stn <span class="sc">==</span> dups<span class="sc">$</span>s_stn[<span class="dv">3</span>] <span class="sc">&amp;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>           s_lat <span class="sc">==</span> dups<span class="sc">$</span>s_lat[<span class="dv">3</span>] <span class="sc">&amp;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>           s_lng <span class="sc">==</span> dups<span class="sc">$</span>s_lng[<span class="dv">3</span>] <span class="sc">&amp;</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>           e_at <span class="sc">==</span> dups<span class="sc">$</span>e_at[<span class="dv">3</span>] <span class="sc">&amp;</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>           m_c <span class="sc">==</span> dups<span class="sc">$</span>m_c[<span class="dv">3</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>##            ride_id rideable_type                 s_at
## 1 190F0B640A9C621F electric_bike 2022-11-01T13:05:08Z
## 2 E4CF5B6A0DED190C electric_bike 2022-11-01T13:05:08Z
##                                    s_stn s_lat s_lng                 e_at
## 1 Public Rack - Woodlawn Ave &amp; 63rd St S 41.78 -87.6 2022-11-01T13:09:38Z
## 2 Public Rack - Woodlawn Ave &amp; 63rd St S 41.78 -87.6 2022-11-01T13:09:38Z
##                      e_stn   e_lat    e_lng    m_c length_dis_km
## 1 University Ave &amp; 57th St 41.7915 -87.5999 member      1.278769
## 2     Harper Ave &amp; 59th St 41.7879 -87.5883 member      1.308716
##   length_time_mins  spd_kph
## 1           4M 30S 17.05025
## 2           4M 30S 17.44954</code></pre>
<p>Appear to just be coincidences</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dups, test, test_f)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(trips, <span class="st">&quot;Cleaned_Trips_Dataset.csv&quot;</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(stn_mst, <span class="st">&quot;Stations_Dataset.csv&quot;</span>)</span></code></pre></div>
<h2 id="trips_wloc">Trips_wloc</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(trips_wloc)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4840166 obs. of  14 variables:
##  $ ride_id         : chr  &quot;E7EB5B75690A9720&quot; &quot;7C9B5555CD23A4A5&quot; &quot;F6A29D3852FE4B05&quot; &quot;2ADEBDB639C80F16&quot; ...
##  $ rideable_type   : chr  &quot;classic_bike&quot; &quot;electric_bike&quot; &quot;classic_bike&quot; &quot;classic_bike&quot; ...
##  $ s_at            : chr  &quot;2022-05-01T00:00:06Z&quot; &quot;2022-05-01T00:00:12Z&quot; &quot;2022-05-01T00:00:19Z&quot; &quot;2022-05-01T00:00:39Z&quot; ...
##  $ s_stn           : chr  &quot;Sheffield Ave &amp; Webster Ave&quot; &quot;Larrabee St &amp; Webster Ave&quot; &quot;Federal St &amp; Polk St&quot; &quot;Sheffield Ave &amp; Webster Ave&quot; ...
##  $ s_lat           : num  41.9 41.9 41.9 41.9 41.9 ...
##  $ s_lng           : num  -87.7 -87.6 -87.6 -87.7 -87.6 ...
##  $ e_at            : chr  &quot;2022-05-01T00:12:56Z&quot; &quot;2022-05-01T00:32:51Z&quot; &quot;2022-05-01T00:15:09Z&quot; &quot;2022-05-01T00:12:52Z&quot; ...
##  $ e_stn           : chr  &quot;Southport Ave &amp; Belmont Ave&quot; &quot;Michigan Ave &amp; Washington St&quot; &quot;Desplaines St &amp; Randolph St&quot; &quot;Southport Ave &amp; Belmont Ave&quot; ...
##  $ e_lat           : num  41.9 41.9 41.9 41.9 41.9 ...
##  $ e_lng           : num  -87.7 -87.6 -87.6 -87.7 -87.6 ...
##  $ m_c             : chr  &quot;casual&quot; &quot;casual&quot; &quot;casual&quot; &quot;casual&quot; ...
##  $ length_dis_km   : num  2.16 4.5 1.87 2.16 1.87 ...
##  $ length_time_mins: chr  &quot;12M 50S&quot; &quot;32M 39S&quot; &quot;14M 50S&quot; &quot;12M 13S&quot; ...
##  $ spd_kph         : num  10.11 8.27 7.56 10.62 7.78 ...</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;test&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Structure&quot;</span>), <span class="st">&quot;pass_fail&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(s_at <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="st">&#39;2022-05-01&#39;</span>) <span class="sc">|</span> e_at <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">&#39;2023-05-01&#39;</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(test) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Date Range&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Date Range&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">between</span>(s_lat, <span class="dv">37</span>, <span class="dv">47</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">between</span>(s_lng, <span class="sc">-</span><span class="dv">92</span>, <span class="sc">-</span><span class="dv">82</span>))</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(test) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Start Loc Range&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Start Loc Range&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">between</span>(e_lat, <span class="dv">37</span>, <span class="dv">47</span>) <span class="sc">|</span> <span class="sc">!</span><span class="fu">between</span>(e_lng, <span class="sc">-</span><span class="dv">92</span>, <span class="sc">-</span><span class="dv">82</span>))</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(test) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;End Loc Range&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;End Loc Range&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(trips_wloc) <span class="sc">==</span> <span class="fu">n_distinct</span>(trips_wloc<span class="sc">$</span>ride_id)) {</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Range ID Uniqueness&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Range ID Uniqueness&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>trips_wloc<span class="sc">$</span>s_stn <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(trips_wloc<span class="sc">$</span>s_stn)</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>stn_mst<span class="sc">$</span>stn <span class="ot">&lt;-</span> <span class="fu">str_squish</span>(stn_mst<span class="sc">$</span>stn)</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">max</span>(<span class="fu">nchar</span>(trips_wloc<span class="sc">$</span>ride_id)) <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">nchar</span>(trips_wloc<span class="sc">$</span>ride_id))) {</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Length&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Length&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips_wloc, <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;^[[:alnum:]]+$&quot;</span>, trips_wloc<span class="sc">$</span>ride_id))) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Alphanumeric&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;Ride ID Alphanumeric&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>trips_wloc<span class="sc">$</span>s_lat <span class="ot">&lt;-</span> <span class="fu">signif</span>(trips_wloc<span class="sc">$</span>s_lat, <span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>trips_wloc<span class="sc">$</span>s_lng <span class="ot">&lt;-</span> <span class="fu">signif</span>(trips_wloc<span class="sc">$</span>s_lng, <span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>trips_wloc<span class="sc">$</span>e_lat <span class="ot">&lt;-</span> <span class="fu">signif</span>(trips_wloc<span class="sc">$</span>e_lat, <span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>trips_wloc<span class="sc">$</span>e_lng <span class="ot">&lt;-</span> <span class="fu">signif</span>(trips_wloc<span class="sc">$</span>e_lng, <span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips_wloc, trips_wloc<span class="sc">$</span>e_at <span class="sc">&gt;</span> trips_wloc<span class="sc">$</span>e_at)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;End Time After Start Time&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;End Time After Start Time&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips_wloc, trips_wloc<span class="sc">$</span>length_time_mins <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> s_stn <span class="sc">==</span> e_stn)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips W Same SE Station Under 3 Mins&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips W Same SE Station Under 3 Mins&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips_wloc, trips_wloc<span class="sc">$</span>length_time_mins <span class="sc">&lt;</span> <span class="dv">1</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Under 1 Min&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Under 1 Min&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips_wloc, (<span class="fu">as.numeric</span>(trips_wloc<span class="sc">$</span>length_time_mins) <span class="sc">/</span> <span class="dv">60</span>) <span class="sc">&gt;</span> <span class="dv">1440</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Over 1 Day&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Trips Over 1 Day&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `(as.numeric(trips_wloc$length_time_mins)/60) &gt; 1440`.
## Caused by warning:
## ! NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips_wloc, trips_wloc<span class="sc">$</span>spd_kph <span class="sc">&gt;</span> <span class="dv">32</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Speeds Over 32Kph&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Speeds Over 32Kph&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> trips_wloc <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rideable_type, s_at, s_stn, s_lat, s_lng, e_at, e_stn, e_lat, e_lng, m_c) <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(rideable_type, s_at, s_stn, s_lat, s_lng, e_at, e_stn, e_lat, e_lng)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;rideable_type&#39;, &#39;s_at&#39;, &#39;s_stn&#39;, &#39;s_lat&#39;,
## &#39;s_lng&#39;, &#39;e_at&#39;, &#39;e_stn&#39;, &#39;e_lat&#39;, &#39;e_lng&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(test) <span class="sc">==</span> <span class="fu">nrow</span>(trips_wloc)) {</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Near Duplicates&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No Near Duplicates&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(trips_wloc, <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>ride_id) <span class="sc">|</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>rideable_type) <span class="sc">|</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>s_at) <span class="sc">|</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>s_stn) <span class="sc">|</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>s_lat) <span class="sc">|</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>s_lng) <span class="sc">|</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>e_at) <span class="sc">|</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>e_stn) <span class="sc">|</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>e_lat) <span class="sc">|</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>e_lng) <span class="sc">|</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>m_c) <span class="sc">|</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>length_dis_km) <span class="sc">|</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>spd_kph) <span class="sc">|</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">is.na</span>(trips_wloc<span class="sc">$</span>length_time_mins))) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No NA Values&quot;</span>,<span class="st">&quot;Pass&quot;</span>))</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(test_results, <span class="fu">c</span>(<span class="st">&quot;No NA Values&quot;</span>,<span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>test_results</span></code></pre></div>
<pre><code>## # A tibble: 14 × 2
##    test                                    pass_fail
##    &lt;chr&gt;                                   &lt;chr&gt;    
##  1 Structure                               Pass     
##  2 Date Range                              Pass     
##  3 Start Loc Range                         Pass     
##  4 End Loc Range                           Pass     
##  5 Range ID Uniqueness                     Pass     
##  6 Ride ID Length                          Pass     
##  7 Ride ID Alphanumeric                    Pass     
##  8 End Time After Start Time               Pass     
##  9 No Trips W Same SE Station Under 3 Mins Fail     
## 10 No Trips Under 1 Min                    Pass     
## 11 No Trips Over 1 Day                     Pass     
## 12 No Speeds Over 32Kph                    Pass     
## 13 No Near Duplicates                      Pass     
## 14 No NA Values                            Pass</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(test, test_results)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(trips_wloc, <span class="st">&quot;Cleaned_Trips_W_Location_Dataset.csv&quot;</span>)</span></code></pre></div>

</main>



</body>
</html>
